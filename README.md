# mkvmerge

Скрипт для объединения звука, субтитров и видео в контейнер .mkv для связки NAS+Plex.  
Запуск:  
```C:\path\mkvmerge.bat "\\NAS\Downloads" 1```, где  
Номер аргумента  | Описание
---------------- | ---------------------------------------------
1                | путь к папке в SMB, где лежат сезоны сериалов
2                | режим слияния

### Режим слияния
Если передать 0, то слияние будет проходить в упрощённом режиме: в одной папке с сезоном сериала должны лежать вместе файлы видео, аудио и субтитров (не обязательно должны быть аудио и субтитры). То есть, к примеру, в папке "Season 1" должны лежать файлы:  
* show episode 1.mkv
* show episode 1.mka
* show episode 1.ass
* show episode 2.mkv
* show episode 2.mka
* show episode 2.ass
* ...  

Соответственно, здесь есть ограничение: одна аудио дорожка и одна дорожка с субтитрами. При этом названия должны совпадать (кроме расширения, естественно).

Если передать 1, то слияние будет проходить в режиме, поддерживающем несколько аудио дорожек и дорожек субтитров. Аудио должны лежать в той же папке с видео, в папках под названием Audio1, Audio2, ... . Субтитры тоже должны лежать в той же папке с видео, но в папках Sub1, Sub2, ... . Количество папок с субтитрами и аудио могут не совпадать, субтитров или аудио может не быть. Однако, количество файлов в папках AudioX и SubX должны совпадать с количеством файлов видео, иначе такая папка не будет обработана. Дорожками по умолчанию назначаются те субтитры или аудио, которые лежат в папках с номерами 1.  
Пример папки "Season 1":  
* show episode 1.mkv
* Audio1\show episode 1.mka
* Audio2\show episode 1.mka
* Sub1\show episode 1.ass
* show episode 2.mkv
* Audio1\show episode 2.mka
* Audio2\show episode 2.mka
* Sub1\show episode 2.ass
* ...  

Так же скрипт создаёт структуру папок для сериала с "нормализованными" наименованиями у результирующих файлов, то есть приводит к формату "show name s01e01.mkv".

### Как работать со скриптом
После запуска скрипт задаст вопрос с количеством сезонов у сериала. Здесь нужно ввести максимальное значение сезона, который на данный момент присутствует. Следующий вопрос будет про то, с какого сезона начинается отсчёт. Вводим минимальное значение сезона, который у нас есть. Далее нужно сопоставить номер папки и сезона. После этого нужно ввести корректное наименование сериала (это нужно для того, чтобы корректно сформировать названия выходных файлов). 

Пример работы:
```
Доступные папки:
  1) Торренты
  2) Из USB
  3) Spy.x.Family.S3.WEB-DL.1080p
  4) Spy.x.Family.Season2.WEB-DL.1080p
  5) Spy x Family

Сколько сезонов в вашем маняме? 3
С какого сезона начинаем считать? 2
Введите номер папки с сезоном 2 из списка выше: 4
Введите номер папки с сезоном 3 из списка выше: 3

Вы выбрали:
Сезон 2: Spy.x.Family.Season2.WEB-DL.1080p
Сезон 3: Spy.x.Family.S3.WEB-DL.1080p
```